<script>
MathJax = { 
    tex: {
    inlineMath: [            
    ['$', '$'],
    ['\\(', '\\)']
    ] }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

# 演習問題

1.1(基本) 関数$y(x,{\bf w})$が多項式(1.1)で与えられたときの(1.2)の二条和誤差関数を考える。この誤差関数を最小にする係数${\bf w}=\{w_i\}$は以下の線形方程式の解として与えられることを示せ。
$$\begin{align}
\sum_{j=0}^MA_{ij}w_j=T_i  \tag{1.122}
\end{align}$$
ただし、
$$\begin{align}
A_{ij}=\sum_{n=1}^N(x_{n})^{i+j}, \hspace{5 em} T_i = \sum_{n=1}^N(x_{n})^{i}t_n\tag{1.123}
\end{align}$$
ここで、下付き添え字の$i$や$j$は成分を表し、$(x)^i$は$x$の$i$乗を表す。


1.1 回答
$$\begin{align}
E&=\frac{1}{2}\sum_{n=1}^N\left(\sum_{j=0}^Mw_jx^j_n-t_n\right)^2\\
\frac{\partial E}{\partial w_i}&=\sum_{n=1}^N\left(\sum_{j=0}^Mw_jx^j_n-t_n\right)x^i_n\\
&=\sum_{n=1}^N\left(\sum_{j=0}^Mw_jx^{j+i}_n-x^i_nt_n\right)\\
&=\sum_{j=0}^M w_j\sum_{n=1}^Nx^{j+i}_n-\sum_{n=1}^N x^i_nt_n=0
\end{align}$$
$$\begin{align}
\sum_{j=0}^MA_{ij}w_j=T_i
\end{align}$$

----

1.2(基本) 正則化された二乗和誤差関数(1.4)を最小化する係数$w_i$が満たす。(1.122)に類似した方程式系を書き下せ。


1.2 回答
$$\begin{align}
E&=\frac{1}{2}\sum_{n=1}^N\left(\sum_{j=0}^Mw_jx^j_n-t_n\right)^2+\frac{\lambda}{2}||{\bf w}||^2\\
\frac{\partial E}{\partial w_i}&=\sum_{n=1}^N\left(\sum_{j=0}^Mw_jx^j_n-t_n\right)x^i_n+\lambda w_i\\
&=\sum_{j=0}^M w_j\left(\sum_{n=1}^Nx^{j+i}_n+\lambda \delta_{ij}\right)-\sum_{n=1}^N x^i_nt_n=0
\end{align}$$
$$\begin{align}
\sum_{j=0}^MA_{ij}'w_j=T_i
\end{align}$$

----

1.3(標準) 3個の色分けされた箱$r$（赤）、$b$（青）、$g$（緑）を考える。箱$r$には３個のりんご、４個のオレンジ、３個のライムが入っており、箱$b$には１個のりんご、１個のオレンジ、０個のライムが入っており、箱$g$には3個のりんご、3個のオレンジ、4個のライムが入っている。箱を$p(r)=0.2$, $p(b)=0.2$, $p(g)=0.6$という確率でランダムに選び、果物を箱から1個取り出す（箱の中のものは等確率で選ばれるとする）とき、りんごを選び出す確率を求めよ。また、選んだ果物がオレンジであったとするとき、それが緑の箱から取り出されたものである確率はいくらか？


1.3 回答
$$\begin{align}
P(aを取り出す)&=P(rを選び かつ りんごをとる)+P(bを選び かつ りんごをとる)+P(gを選び かつ りんごをとる)\\
&=P(rを選ぶ)P(aを取り出す|rを選ぶ)\\& \ \ +P(bを選ぶ) P((aを取り出す|bを選ぶ)\\&\ \ + P(gを選ぶ)P( (aを取り出す|gを選ぶ)\\
&=0.2*3/(3+4+3)+0.2*1/(1+1+0)+0.6*3/(3+3+4)\\
&=0.2*0.3+0.2*0.5+0.6*0.3=0.34
\end{align}$$

$$\begin{align}
P(gを選ぶ|oを取る)=P(oを取る|gを選ぶ)*P(gを選ぶ)
\end{align}$$
$$\begin{align}
P(oを取る|gを選ぶ)=0.3より\\
P(gを選ぶ|oを取る)=0.3*0.6=0.18
\end{align}$$

----

1.4(標準) 連続変数$x$上で定義された確率密度$p_x(x)$を考える。$x=g(y)$により非線形変換を施すと密度は(1.27)の変換を受ける。(1.27)を微分して、$y$に関する密度を最大化する位置$\hat{y}$と$x$に関数る密度を最大にする位置$\hat{x}$とが、ヤコビ因子の影響により一般には単純な$\hat{x}=g({\hat y})$という関係にないことを示せ。これはっ区立密度の最大値が、（通常の関数と異なり）変数の選択に依存することを示している。線形変換の場合には最大値の位置が変数地震と同じ変換をけることをたしかめよ。


1.4 回答
$$\begin{align}
p_y(y) = p_x(g(y))\left|\frac{dx}{dy}\right|\\
\frac{d}{dy}p_y(y) = \frac{dg(y)}{dy}\frac{d}{dx}\left\{p_x(x)\left|\frac{dx}{dy}\right|\right\}=0\\
\end{align}$$
$$\begin{align}
\frac{d}{dx}\left\{p_x(x)\left|\frac{dx}{dy}\right|\right\}=0\\
\frac{dp_x(x)}{dx}\left|\frac{dg(y)}{dy}\right|+p_x(x)\frac{d}{dx}\left|\frac{dg(y)}{dy}\right|=0
\end{align}$$
上記の式を満たす$x$をかんがえる。$x={\hat x}$は第一項を0にするが、第二項は一般には0にならない。
$g(y)$が線形変換のときは変換のときは第二項は0になるため、$x={\hat x}$が解になる

----
1.5(基本) (1.38)を使って、var[f(x)]が(1.39)を満たすことを示せ


1.5 回答
$$\begin{align}
{\rm var}[f(x)]&=\mathbb{E}_x\left[\left(f(x)-\mathbb{E}_x[f(x)]\right)^2\right]\\
&=\mathbb{E}_x\left[f(x)^2-2f(x)\mathbb{E}_x[f(x)]+\mathbb{E}_x[f(x)]^2\right]\\
&=\mathbb{E}_x\left[f(x)^2\right]-\mathbb{E}_x[f(x)]^2
\end{align}$$

----

1.6(基本) ２つの変数$x$,$y$が独立なら、それらの共分散が0になることを示せ。


1.6 回答
$$\begin{align}
{\rm cov}[x,y]&=\mathbb{E}_{x,y}[xy]-\mathbb{E}_{x}[x]\mathbb{E}_{y}[y]\\
\mathbb{E}_{x,y}[xy]&=\int dx\int dyxy f_{XY}(x,y)=\int dx\int dyxy f_X(x)f_Y(y)=\mathbb{E}_{x}[x]\mathbb{E}_{y}[y]
\end{align}$$
$$\begin{align}
x, y が独立 \Rightarrow {\rm cov}[x,y]&=0
\end{align}$$

----

1.7(基本) ２つの変数$x$,$y$が独立なら、それらの共分散が0になることを示せ。


1.6 回答
$$\begin{align}
{\rm cov}[x,y]&=\mathbb{E}_{x,y}[xy]-\mathbb{E}_{x}[x]\mathbb{E}_{y}[y]\\
\mathbb{E}_{x,y}[xy]&=\int dx\int dyxy f_{XY}(x,y)=\int dx\int dyxy f_X(x)f_Y(y)=\mathbb{E}_{x}[x]\mathbb{E}_{y}[y]
\end{align}$$
$$\begin{align}
x, y が独立 \Rightarrow {\rm cov}[x,y]&=0
\end{align}$$
